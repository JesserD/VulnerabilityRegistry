using Domain;
using FluentValidation;

namespace Application.Vulnerabilities;

public class IdValidator : AbstractValidator<string>
{
    public IdValidator()
    {
        RuleFor(id => id)
        .NotNull().WithMessage("Id must not be null.")
        .NotEmpty().WithMessage("Id must not be empty.")
        .Must(Vulnerability.IsValidStixVulnerabilityId).WithMessage("Id must follow the format 'vulnerability--<UUID>'.");
    }
}
